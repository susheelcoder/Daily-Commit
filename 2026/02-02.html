<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Haproven Timer â€“ Install App</title>

  <!-- PWA META -->
  <meta name="theme-color" content="#0a0c10">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="icon" href="https://img.icons8.com/color/512/stopwatch.png">
  <link rel="manifest" id="manifestLink">

  <style>
    body{
      margin:0;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#0a0c10;
      color:#00ff9d;
      font-family:Segoe UI,system-ui;
      flex-direction:column;
      text-align:center;
    }
    button{
      margin-top:20px;
      padding:14px 28px;
      font-size:1.1rem;
      font-weight:700;
      border:none;
      border-radius:12px;
      background:#00ff9d;
      color:#000;
      cursor:pointer;
    }
    @media (display-mode: standalone){
      #installBtn{display:none}
    }
  </style>
</head>

<body>

  <h1>Haproven Timer</h1>
  <p>Install the App</p>

  <button id="installBtn" onclick="installApp()">ðŸ“² Install App</button>

<script>
/* ================= MANIFEST ================= */
const manifest = {
  name: "Haproven Timer",
  short_name: "Timer",
  start_url: ".",
  scope: ".",
  display: "standalone",
  background_color: "#0a0c10",
  theme_color: "#00ff9d",
  icons: [
    {
      src: "https://img.icons8.com/color/192/stopwatch.png",
      sizes: "192x192",
      type: "image/png"
    },
    {
      src: "https://img.icons8.com/color/512/stopwatch.png",
      sizes: "512x512",
      type: "image/png"
    }
  ]
};

const blob = new Blob([JSON.stringify(manifest)], { type:"application/json" });
document.getElementById("manifestLink").href = URL.createObjectURL(blob);

/* ================= INSTALL FUNCTION ================= */
let deferredPrompt;

window.addEventListener("beforeinstallprompt", e => {
  e.preventDefault();
  deferredPrompt = e;
});

async function installApp(){
  if(!deferredPrompt){
    alert("Browser menu â†’ Install App");
    return;
  }
  deferredPrompt.prompt();
  await deferredPrompt.userChoice;
  deferredPrompt = null;
}

/* ================= SERVICE WORKER ================= */
if("serviceWorker" in navigator){
  const swCode = `
    self.addEventListener("install", e => self.skipWaiting());
    self.addEventListener("activate", e => self.clients.claim());
    self.addEventListener("fetch", e => e.respondWith(fetch(e.request)));
  `;
  const swBlob = new Blob([swCode], { type:"text/javascript" });
  navigator.serviceWorker.register(URL.createObjectURL(swBlob));
}
</script>

</body>
</html>
