<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Timer Pro</title>

<meta name="theme-color" content="#090a0f">
<link rel="manifest" id="manifestLink">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
html,body{height:100%;}
body{
    min-height:100svh;
    background:#090a0f;
    display:flex;
    justify-content:center;
    align-items:center;
    color:#fff;
    overflow:hidden;
}

/* Menu */
.header-actions{position:absolute;top:15px;right:15px;}
.menu-btn{
    background:none;border:none;cursor:pointer;
    padding:10px;border-radius:50%;
}
.menu-btn:hover{background:rgba(255,255,255,.1);}

.dropdown{
    position:absolute;
    top:45px;right:0;
    background:#1a1b26;
    border-radius:12px;
    display:none;
    flex-direction:column;
    width:180px;
    overflow:hidden;
    box-shadow:0 10px 30px rgba(0,0,0,.7);
    z-index:1000;
}
.dropdown button{
    background:none;
    color:white;
    padding:14px;
    border:none;
    border-bottom:1px solid #222;
    cursor:pointer;
    text-align:left;
}
.dropdown button:hover{background:#2a2c3d;}
.dropdown button:last-child{border-bottom:none}

/* Timer */
.container{width:95%;max-width:500px;text-align:center;}
.display{
    font-size:7rem;
    font-weight:800;
    font-family:'Courier New',monospace;
    color:#00ff9d;
}
.ms{font-size:2.5rem;opacity:.4}

input{
    background:#111;
    border:1px solid #333;
    border-radius:8px;
    color:#00ff9d;
    font-size:1.2rem;
    text-align:center;
    padding:8px;
    width:160px;
    margin:25px 0;
}

.controls{display:flex;flex-direction:column;gap:12px;}
.start-btn{
    padding:18px;
    font-size:1.8rem;
    border-radius:18px;
    border:none;
    background:#00ff9d;
    color:#000;
    cursor:pointer;
}
.start-btn:active{transform:scale(.97)}

.secondary-btns{display:flex;gap:8px}
.secondary-btns button{
    flex:1;
    padding:14px;
    border:none;
    border-radius:12px;
    color:#fff;
    font-weight:bold;
    cursor:pointer;
}
.stop{background:#ff4d4d}
.reset{background:#333}
.lap{background:#00c6ff}

.laps-box{
    margin-top:20px;
    max-height:120px;
    overflow-y:auto;
    font-size:.85rem;
    border-top:1px solid #111;
    padding-top:10px;
}
</style>
</head>

<body>

<div class="header-actions">
<button class="menu-btn" onclick="toggleMenu()">â‹®</button>
<div class="dropdown" id="menu">
<button onclick="toggleFull()">Full Screen</button>
<button id="installBtn" style="display:none" onclick="installApp()">ðŸ“² Install App</button>
<button onclick="resetTimer()">Reset All</button>
<button onclick="alert('Smart Timer Pro v2.1')">About</button>
</div>
</div>

<div class="container">
<div class="display">
<span id="time">00:00:00</span><br>
<span class="ms">.<span id="ms">000</span></span>
</div>

<input id="input" value="00:00:00">

<div class="controls">
<button class="start-btn" id="start" onclick="startPause()">START</button>
<div class="secondary-btns">
<button class="stop" onclick="pause()">STOP</button>
<button class="reset" onclick="resetTimer()">RESET</button>
<button class="lap" onclick="lap()">LAP</button>
</div>
</div>

<div class="laps-box" id="laps"></div>
</div>

<script>
let t=null,running=false,ms=0,mode="up";

const timeEl=time=document.getElementById("time");
const msEl=document.getElementById("ms");
const input=document.getElementById("input");
const startBtn=document.getElementById("start");
const menu=document.getElementById("menu");

function toggleMenu(){menu.style.display=menu.style.display==="flex"?"none":"flex"}
document.onclick=e=>{if(!e.target.closest(".header-actions"))menu.style.display="none"}

function format(v){
let s=Math.floor(v/1000);
let h=Math.floor(s/3600);
let m=Math.floor((s%3600)/60);
let se=s%60;
timeEl.textContent=`${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(se).padStart(2,"0")}`;
msEl.textContent=String(v%1000).padStart(3,"0");
}

function startPause(){
if(running)return;
let p=input.value.split(":").map(Number);
if(ms===0 && p.length===3 && p.some(v=>v>0)){
ms=(p[0]*3600+p[1]*60+p[2])*1000;
mode="down";
}else if(ms===0){mode="up"}

running=true;
startBtn.textContent="RUNNING";

t=setInterval(()=>{
if(mode==="up")ms+=10;
else{
ms-=10;
if(ms<=0){ms=0;beep();pause()}
}
format(ms);
},10);
}

function pause(){
clearInterval(t);
running=false;
startBtn.textContent="START";
}

function resetTimer(){
pause();
ms=0;
format(0);
input.value="00:00:00";
document.getElementById("laps").innerHTML="";
menu.style.display="none";
}

function lap(){
let l=document.createElement("div");
l.style.display="flex";
l.style.justifyContent="space-between";
l.innerHTML=`<span>Lap ${laps.children.length+1}</span><span>${timeEl.textContent}.${msEl.textContent}</span>`;
laps.prepend(l);
}

function beep(){
let a=new AudioContext();
let o=a.createOscillator();
o.frequency.value=900;
o.connect(a.destination);
o.start();
setTimeout(()=>o.stop(),500);
}

function toggleFull(){
document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen();
menu.style.display="none";
}
</script>

</body>
</html>